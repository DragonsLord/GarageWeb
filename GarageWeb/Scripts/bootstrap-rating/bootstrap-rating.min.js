!function(t,n){"use strict";var a=5;t.fn.rating=function(s){return this.each(function(){var i=t(this);if(!i.data("rating")){i.data("rating",!0);var e=t.extend({},i.data(),s);e.start=parseInt(e.start,10),e.start=isNaN(e.start)?n:e.start,e.stop=parseInt(e.stop,10),e.stop=isNaN(e.stop)?e.start+a||n:e.stop,e.step=parseInt(e.step,10)||n,e.fractions=Math.abs(parseInt(e.fractions,10))||n,e.scale=Math.abs(parseInt(e.scale,10))||n,e=t.extend({},t.fn.rating.defaults,e);for(var o=function(t){var n=Math.floor(t);f.find(".rating-symbol-background").css("visibility","visible").slice(0,n).css("visibility","hidden");var a=f.find(".rating-symbol-foreground");a.width(0),a.slice(0,n).width("auto"),a.eq(n).width(t%1*100+"%")},r=function(t){return e.start+Math.floor(t)*e.step+e.step*p(t%1)},l=function(t){return(t-e.start)/e.step},p=function(t){var n=Math.ceil(t%1*e.fractions)/e.fractions,a=Math.pow(10,e.scale);return Math.floor(t)+Math.floor(n*a)/a},c=function(t){var n=e.step>0?e.start:e.stop,a=e.step>0?e.stop:e.start;return t>=n&&a>=t},u=function(t){var n=parseFloat(t);c(n)&&o(l(n))},d=function(t){return function(n){i.prop("disabled")||i.prop("readonly")||t.call(this,n)}},f=t("<span></span>").insertBefore(i),v=1;v<=l(e.stop);v++){var h=t('<div class="rating-symbol"></div>').css({display:"inline-block",position:"relative"});t('<div class="rating-symbol-background '+e.empty+'"></div>').appendTo(h),t('<div class="rating-symbol-foreground"></div>').append('<span class="'+e.filled+'"></span>').css({display:"inline-block",position:"absolute",overflow:"hidden",left:0,width:0}).appendTo(h),f.append(h),e.extendSymbol.call(h,r(v))}u(i.val()),i.on("change",function(){var n=t(this).next("input").val(),a=t(this).next("input").next("input").val();t.ajax({url:"/Menu/UpdateRating",data:{__RequestVerificationToken:a,value:t(this).val(),dishID:n},dataType:"JSON",type:"POST",success:function(t){i.prop("readonly","true"),u(t)}})});var g=function(n){var a=t(n.currentTarget),s=(n.pageX||n.originalEvent.touches[0].pageX)-a.offset().left;return a.index()+s/a.width()};f.on("mousedown touchstart",".rating-symbol",d(function(t){i.val(r(g(t))).change()})).on("mousemove touchmove",".rating-symbol",d(function(t){o(p(g(t)))})).on("mouseleave touchend",".rating-symbol",d(function(){o(l(parseFloat(i.val())))}))}})},t.fn.rating.defaults={filled:"glyphicon glyphicon-star",empty:"glyphicon glyphicon-star-empty",start:0,stop:a,step:1,fractions:1,scale:3,extendSymbol:function(t){}},t(function(){t("input.rating").rating()})}(jQuery);